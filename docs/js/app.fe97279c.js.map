{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components sync .+\\.(vue|js|ts)$","webpack:///./src/components/TrackCanvas.vue","webpack:///./src/components/TrackCanvas.vue?56d9","webpack:///./src/components/TrackCanvas.vue?2edf","webpack:///./src/components/TrackCanvas.vue?075d","webpack:///./src/components/DemoChooser.vue?fb90","webpack:///./src/components/DemoChooser.vue","webpack:///./src/components/DemoChooser.vue?12d1","webpack:///./src/components/DemoChooser.vue?4a20","webpack:///./src/App.vue","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?dfb6","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","map","webpackContext","req","id","webpackContextResolve","e","Error","code","keys","resolve","class","style","ref","canvasMouseDown","canvasMouseMove","documentMouseup","width","height","type","min","max","trackWidth","derivedWidth","disabled","Math","round","spacing","derivedSpacingRed","derivedSpacingBlue","freezeGroundTruth","reset","download","addMissingPressed","calculatePython","pythonLoading","openDemo","YAMLFilesChange","JSONFilesChange","outputError","rows","output","wrap","drawing","lastPos","startPos","distance","nextDotTargetDistance","trackData","pylons","groundTruth","detection","pyodide","groundTruthToBeAdded","this","canvas","getContext","$refs","loadPyodide","indexURL","fetch","text","console","warn","loadPackagesFromImports","p2","sqrt","pow","event","target","getBoundingClientRect","offsetX","x","offsetY","y","clientX","clientY","radius","fill","color","drawCircleRaw","context","beginPath","arc","PI","fillStyle","from","offset","to","plus","headlen","dx","dy","angle","atan2","moveTo","lineTo","cos","sin","strokeStyle","stroke","clearRect","getPos","distDelta","drawCircle","endPoint","closest","reduce","a","b","undetect","hidden","filtered","filter","JSON","stringify","blueDetected","yellowDetected","midLine","entries","split","trim","fromEntries","parse","cone_blue","cone_yellow","faulty_cones","cone_blue_detected","cone_yellow_detected","redraw","deriveSpacing","points","arr","sort","median","point","findClosestPoint","addMissing","group1","group2","spacing1","spacing2","fac","rot","norm","add","mul","drawArrow","dataStr","encodeURIComponent","dlAnchorElem","document","getElementById","setAttribute","click","globals","set","runPythonAsync","log","toJs","fileName","loadYAMLFile","files","cones_left","cones_orange","cones_orange_big","cones_right","parsedSets","list","parseFloat","flat","minX","maxX","minY","maxY","scale","trackSets","forEach","strokePolygon","pointsArray","strokeColor","circles","Array","mean","num","render","role","showModal","tracks","track","select","path","src","img","_","$emit","href","app","requireComponent","componentConfig","componentName","pop","replace","component","default","mount"],"mappings":"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","file":"js/app.fe97279c.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/BachelorThesisRaceyard/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var map = {\n\t\"./DemoChooser.vue\": \"a9cc\",\n\t\"./TrackCanvas.vue\": \"1cff\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"0b29\";","<template>\n    <div class=\"d-flex\">\n        <div>\n            <canvas\n                ref=\"canvas\"\n                @mousedown=\"canvasMouseDown\"\n                @mousemove=\"canvasMouseMove\"\n                @mouseup=\"documentMouseup\"\n                width=\"500\"\n                height=\"500\"\n            ></canvas>\n        </div>\n        <div class=\"ms-3\" style=\"flex: 1\">\n            <div class=\"form-group\">\n                <label>track width</label>\n                <div class=\"d-flex\">\n                    <input type=\"range\" class=\"form-range w-0 flex-1\" min=\"1\" max=\"100\" v-model.number=\"trackWidth\" />\n                    <output class=\"ms-2\">{{ trackWidth }}</output>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label>derived width</label>\n                <div class=\"d-flex\">\n                    <input type=\"range\" class=\"form-range w-0 flex-1\" min=\"1\" max=\"100\" :value=\"derivedWidth / 2\" disabled />\n                    <output class=\"ms-2\">{{ Math.round(derivedWidth / 2) }}</output>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label>spacing</label>\n                <div class=\"d-flex\">\n                    <input type=\"range\" class=\"form-range w-0 flex-1\" min=\"1\" max=\"100\" v-model.number=\"spacing\" />\n                    <output class=\"ms-2\">{{ spacing }}</output>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label>derived spacing</label>\n                <div class=\"d-flex\">\n                    <input type=\"range\" class=\"form-range w-0 flex-1 handle-red\" min=\"1\" max=\"100\" :value=\"derivedSpacingRed\" disabled />\n                    <output class=\"ms-2\">{{ Math.round(derivedSpacingRed) }}</output>\n                </div>\n                <div class=\"d-flex\">\n                    <input type=\"range\" class=\"form-range w-0 flex-1 handle-blue\" min=\"1\" max=\"100\" :value=\"derivedSpacingBlue\" disabled />\n                    <output class=\"ms-2\">{{ Math.round(derivedSpacingBlue) }}</output>\n                </div>\n            </div>\n            <div class=\"form-group\">\n                <label>freeze ground truth</label>\n                <input type=\"checkbox\" class=\"form-check\" v-model=\"freezeGroundTruth\" />\n            </div>\n\n            <button @click=\"reset\" class=\"btn btn-danger my-2 me-4\">Reset</button>\n            <button @click=\"download\" class=\"btn btn-secondary my-2 me-4\">Download</button>\n            <button @click=\"addMissingPressed\" class=\"btn btn-info my-2 me-4\">Add missing</button>\n            <button @click=\"calculatePython\" class=\"btn btn-success my-2\" :disabled=\"pythonLoading\">\n                Calculate Python Midline <span v-if=\"pythonLoading\">(loading...)</span>\n            </button>\n            <hr />\n            <a id=\"downloadAnchorElem\" style=\"display: none\"></a>\n            <div class=\"form-group\">\n                <DemoChooser @fileSelected=\"openDemo\" />\n            </div>\n            <div class=\"form-group\">\n                <label>import YAML</label>\n                <input @change=\"YAMLFilesChange\" type=\"file\" class=\"form-control\" />\n            </div>\n            <div class=\"form-group\">\n                <label>open JSON</label>\n                <input @change=\"JSONFilesChange\" type=\"file\" class=\"form-control\" />\n            </div>\n            <hr />\n            <div class=\"alert alert-danger\" v-if=\"outputError\">{{ outputError }}</div>\n            <div class=\"form-group\">\n                <label>output</label>\n                <textarea class=\"form-control\" rows=\"7\" v-model=\"output\" wrap=\"off\"></textarea>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\">\ninterface Pylon {\n    x: number;\n    y: number;\n    color: string;\n    hidden?: boolean;\n    undetect?: boolean;\n}\ninterface Track {\n    pylons: Pylon[];\n    groundTruth: [number, number][];\n}\ninterface Detection {\n    blueDetected?: [number, number][];\n    yellowDetected?: [number, number][];\n    midLine?: [number, number][];\n}\n\ninterface YAMLFile {\n    cones_left: string[];\n    cones_orange: string[];\n    cones_orange_big: string[];\n    cones_right: string[];\n    middle_points: string[];\n    starting_pose_front_wing: number[];\n    tk_device: string[];\n}\n\n/**\n * NOTES:\n * do the AI stuff with perceptilabs.com/papers\n */\nimport { Options, Vue } from \"vue-class-component\";\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n//@ts-ignore\nimport * as YAML from \"yamljs\";\ndeclare let loadPyodide: (opt: { indexURL: string }) => Promise<{\n    runPython: (code: string) => any;\n    runPythonAsync: (code: string) => any;\n    loadPackagesFromImports: (code: string) => any;\n    globals: {\n        get: (key: \"result\") => {\n            toJs: () => any;\n        };\n        set: (key: \"args\", value: any) => void;\n    };\n}>;\ntype Await<T> = T extends PromiseLike<infer U> ? U : T;\n\n@Options({})\nexport default class TrackCanvas extends Vue {\n    private spacing = 30;\n    private trackWidth = 10;\n\n    private drawing = false;\n    private lastPos = [0, 0] as [number, number];\n    private startPos = [0, 0] as [number, number];\n\n    private distance = 0;\n    private nextDotTargetDistance = this.spacing;\n    private trackData = { pylons: [], groundTruth: [] } as Track;\n    private detection = {} as Detection;\n\n    private outputError = \"\";\n\n    get context() {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return this.canvas.getContext(\"2d\")!;\n    }\n    get canvas() {\n        return this.$refs.canvas as HTMLCanvasElement;\n    }\n\n    private pyodide = null as Await<ReturnType<typeof loadPyodide>> | null;\n    async mounted() {\n        /*this.output = `\n            groundTruth = [[78.2,87.39],[78.20455169677734,83.3948974609375],[83.20455169677734,78.3948974609375],[89.20455169677734,73.3948974609375],[93.20455169677734,71.3948974609375],[97.20455169677734,68.3948974609375],[101.20455169677734,67.3948974609375],[109.20455169677734,62.3948974609375],[116.20455169677734,59.3948974609375],[123.20455169677734,57.3948974609375],[131.20455169677734,56.3948974609375],[136.20455169677734,53.3948974609375],[144.20455169677734,52.3948974609375],[154.20455169677734,50.3948974609375],[166.20455169677734,48.3948974609375],[174.20455169677734,46.3948974609375],[182.20455169677734,45.3948974609375],[194.20455169677734,45.3948974609375],[202.20455169677734,43.3948974609375],[214.20455169677734,42.3948974609375],[222.20455169677734,42.3948974609375],[229.20455169677734,42.3948974609375],[238.20455169677734,42.3948974609375],[248.20455169677734,42.3948974609375],[255.20455169677734,42.3948974609375],[259.20455169677734,42.3948974609375],[267.20455169677734,42.3948974609375],[275.20455169677734,42.3948974609375],[283.20455169677734,42.3948974609375],[288.20455169677734,42.3948974609375],[295.20455169677734,43.3948974609375],[299.20455169677734,45.3948974609375],[309.20455169677734,46.3948974609375],[316.20455169677734,47.3948974609375],[321.20455169677734,49.3948974609375],[328.20455169677734,49.3948974609375],[336.20455169677734,52.3948974609375],[340.20455169677734,53.3948974609375],[347.20455169677734,56.3948974609375],[351.20455169677734,57.3948974609375],[353.20455169677734,57.3948974609375],[355.20455169677734,61.3948974609375],[357.20455169677734,61.3948974609375],[359.20455169677734,63.3948974609375],[361.20455169677734,66.3948974609375],[362.20455169677734,67.3948974609375],[364.20455169677734,70.3948974609375],[366.20455169677734,74.3948974609375],[367.20455169677734,77.3948974609375],[368.20455169677734,82.3948974609375],[368.20455169677734,85.3948974609375],[371.20455169677734,88.3948974609375],[371.20455169677734,90.3948974609375],[371.20455169677734,93.3948974609375],[371.20455169677734,98.3948974609375],[371.20455169677734,99.3948974609375],[371.20455169677734,104.3948974609375],[370.20455169677734,108.3948974609375],[369.20455169677734,111.3948974609375],[369.20455169677734,116.3948974609375],[368.20455169677734,120.3948974609375],[366.20455169677734,125.3948974609375],[365.20455169677734,127.3948974609375],[364.20455169677734,128.3948974609375],[362.20455169677734,133.3948974609375],[359.20455169677734,138.3948974609375],[358.20455169677734,140.3948974609375],[355.20455169677734,142.3948974609375],[352.20455169677734,146.3948974609375],[350.20455169677734,147.3948974609375],[348.20455169677734,148.3948974609375],[346.20455169677734,149.3948974609375],[343.20455169677734,152.3948974609375],[339.20455169677734,154.3948974609375],[335.20455169677734,155.3948974609375],[333.20455169677734,157.3948974609375],[331.20455169677734,158.3948974609375],[327.20455169677734,159.3948974609375],[323.20455169677734,161.3948974609375],[318.20455169677734,164.3948974609375],[315.20455169677734,168.3948974609375],[313.20455169677734,168.3948974609375],[311.20455169677734,169.3948974609375],[307.20455169677734,171.3948974609375],[306.20455169677734,171.3948974609375],[304.20455169677734,174.3948974609375],[302.20455169677734,176.3948974609375],[299.20455169677734,177.3948974609375],[298.20455169677734,178.3948974609375],[296.20455169677734,179.3948974609375],[295.20455169677734,180.3948974609375],[293.20455169677734,182.3948974609375],[291.20455169677734,184.3948974609375],[290.20455169677734,185.3948974609375],[289.20455169677734,186.3948974609375],[289.20455169677734,188.3948974609375],[288.20455169677734,189.3948974609375],[287.20455169677734,193.3948974609375],[287.20455169677734,195.3948974609375],[286.20455169677734,197.3948974609375],[286.20455169677734,198.3948974609375],[286.20455169677734,200.3948974609375],[286.20455169677734,204.3948974609375],[286.20455169677734,206.3948974609375],[286.20455169677734,208.3948974609375],[286.20455169677734,212.3948974609375],[287.20455169677734,214.3948974609375],[287.20455169677734,216.3948974609375],[289.20455169677734,218.3948974609375],[289.20455169677734,219.3948974609375],[290.20455169677734,222.3948974609375],[291.20455169677734,224.3948974609375],[292.20455169677734,227.3948974609375],[294.20455169677734,228.3948974609375],[295.20455169677734,230.3948974609375],[297.20455169677734,231.3948974609375],[298.20455169677734,232.3948974609375],[299.20455169677734,234.3948974609375],[300.20455169677734,236.3948974609375],[301.20455169677734,237.3948974609375],[302.20455169677734,238.3948974609375],[304.20455169677734,239.3948974609375],[306.20455169677734,240.3948974609375],[307.20455169677734,241.3948974609375],[308.20455169677734,243.3948974609375],[310.20455169677734,243.3948974609375],[311.20455169677734,244.3948974609375],[313.20455169677734,245.3948974609375],[315.20455169677734,246.3948974609375],[317.20455169677734,247.3948974609375],[318.20455169677734,247.3948974609375],[321.20455169677734,249.3948974609375],[323.20455169677734,250.3948974609375],[325.20455169677734,250.3948974609375],[328.20455169677734,251.3948974609375],[330.20455169677734,252.3948974609375],[334.20455169677734,252.3948974609375],[337.20455169677734,254.3948974609375],[338.20455169677734,254.3948974609375],[340.20455169677734,254.3948974609375],[342.20455169677734,257.3948974609375],[345.20455169677734,257.3948974609375],[348.20455169677734,258.3948974609375],[350.20455169677734,260.3948974609375],[354.20455169677734,260.3948974609375],[358.20455169677734,263.3948974609375],[360.20455169677734,265.3948974609375],[362.20455169677734,266.3948974609375],[367.20455169677734,267.3948974609375],[370.20455169677734,272.3948974609375],[372.20455169677734,272.3948974609375],[375.20455169677734,274.3948974609375],[377.20455169677734,276.3948974609375],[378.20455169677734,278.3948974609375],[380.20455169677734,278.3948974609375],[382.20455169677734,280.3948974609375],[385.20455169677734,282.3948974609375],[386.20455169677734,284.3948974609375],[387.20455169677734,287.3948974609375],[388.20455169677734,288.3948974609375],[389.20455169677734,290.3948974609375],[390.20455169677734,292.3948974609375],[390.20455169677734,293.3948974609375],[393.20455169677734,296.3948974609375],[393.20455169677734,297.3948974609375],[394.20455169677734,298.3948974609375],[395.20455169677734,300.3948974609375],[395.20455169677734,303.3948974609375],[396.20455169677734,305.3948974609375],[396.20455169677734,307.3948974609375],[396.20455169677734,311.3948974609375],[397.20455169677734,311.3948974609375],[397.20455169677734,316.3948974609375],[397.20455169677734,317.3948974609375],[397.20455169677734,322.3948974609375],[397.20455169677734,326.3948974609375],[397.20455169677734,329.3948974609375],[397.20455169677734,334.3948974609375],[397.20455169677734,337.3948974609375],[397.20455169677734,339.3948974609375],[397.20455169677734,343.3948974609375],[397.20455169677734,346.3948974609375],[397.20455169677734,347.3948974609375],[397.20455169677734,348.3948974609375],[396.20455169677734,354.3948974609375],[395.20455169677734,356.3948974609375],[395.20455169677734,357.3948974609375],[395.20455169677734,358.3948974609375],[393.20455169677734,360.3948974609375],[392.20455169677734,362.3948974609375],[391.20455169677734,364.3948974609375],[389.20455169677734,368.3948974609375],[388.20455169677734,369.3948974609375],[387.20455169677734,373.3948974609375],[386.20455169677734,375.3948974609375],[384.20455169677734,377.3948974609375],[382.20455169677734,378.3948974609375],[381.20455169677734,381.3948974609375],[378.20455169677734,383.3948974609375],[378.20455169677734,385.3948974609375],[376.20455169677734,386.3948974609375],[374.20455169677734,388.3948974609375],[372.20455169677734,390.3948974609375],[368.20455169677734,391.3948974609375],[365.20455169677734,392.3948974609375],[360.20455169677734,395.3948974609375],[358.20455169677734,396.3948974609375],[356.20455169677734,398.3948974609375],[352.20455169677734,398.3948974609375],[349.20455169677734,399.3948974609375],[344.20455169677734,402.3948974609375],[341.20455169677734,403.3948974609375],[338.20455169677734,404.3948974609375],[334.20455169677734,406.3948974609375],[329.20455169677734,407.3948974609375],[326.20455169677734,408.3948974609375],[321.20455169677734,408.3948974609375],[319.20455169677734,409.3948974609375],[315.20455169677734,411.3948974609375],[312.20455169677734,412.3948974609375],[306.20455169677734,413.3948974609375],[304.20455169677734,413.3948974609375],[302.20455169677734,414.3948974609375],[298.20455169677734,415.3948974609375],[293.20455169677734,417.3948974609375],[287.20455169677734,417.3948974609375],[284.20455169677734,418.3948974609375],[279.20455169677734,418.3948974609375],[275.20455169677734,418.3948974609375],[270.20455169677734,419.3948974609375],[268.20455169677734,419.3948974609375],[263.20455169677734,420.3948974609375],[255.20455169677734,420.3948974609375],[252.20455169677734,420.3948974609375],[245.20455169677734,420.3948974609375],[239.20455169677734,420.3948974609375],[232.20455169677734,420.3948974609375],[225.20455169677734,420.3948974609375],[217.20455169677734,420.3948974609375],[214.20455169677734,420.3948974609375],[208.20455169677734,420.3948974609375],[202.20455169677734,420.3948974609375],[196.20455169677734,420.3948974609375],[191.20455169677734,420.3948974609375],[188.20455169677734,420.3948974609375],[185.20455169677734,420.3948974609375],[181.20455169677734,420.3948974609375],[173.20455169677734,420.3948974609375],[169.20455169677734,418.3948974609375],[162.20455169677734,418.3948974609375],[156.20455169677734,417.3948974609375],[151.20455169677734,416.3948974609375],[143.20455169677734,413.3948974609375],[139.20455169677734,410.3948974609375],[129.20455169677734,408.3948974609375],[125.20455169677734,407.3948974609375],[118.20455169677734,404.3948974609375],[112.20455169677734,401.3948974609375],[106.20455169677734,398.3948974609375],[99.20455169677734,398.3948974609375],[98.20455169677734,396.3948974609375],[92.20455169677734,393.3948974609375],[89.20455169677734,391.3948974609375],[83.20455169677734,386.3948974609375],[79.20455169677734,384.3948974609375],[77.20455169677734,380.3948974609375],[71.20455169677734,377.3948974609375],[68.20455169677734,371.3948974609375],[65.20455169677734,368.3948974609375],[63.204551696777344,365.3948974609375],[60.204551696777344,358.3948974609375],[59.204551696777344,352.3948974609375],[57.204551696777344,347.3948974609375],[56.204551696777344,343.3948974609375],[55.204551696777344,338.3948974609375],[55.204551696777344,333.3948974609375],[54.204551696777344,328.3948974609375],[54.204551696777344,324.3948974609375],[54.204551696777344,319.3948974609375],[54.204551696777344,315.3948974609375],[54.204551696777344,310.3948974609375],[54.204551696777344,307.3948974609375],[54.204551696777344,302.3948974609375],[54.204551696777344,297.3948974609375],[55.204551696777344,290.3948974609375],[56.204551696777344,286.3948974609375],[58.204551696777344,282.3948974609375],[59.204551696777344,279.3948974609375],[59.204551696777344,275.3948974609375],[59.204551696777344,273.3948974609375],[59.204551696777344,268.3948974609375],[60.204551696777344,264.3948974609375],[62.204551696777344,259.3948974609375],[62.204551696777344,257.3948974609375],[64.20455169677734,252.3948974609375],[64.20455169677734,248.3948974609375],[65.20455169677734,243.3948974609375],[67.20455169677734,238.3948974609375],[69.20455169677734,232.3948974609375],[70.20455169677734,228.3948974609375],[71.20455169677734,226.3948974609375],[71.20455169677734,224.3948974609375],[71.20455169677734,219.3948974609375],[71.20455169677734,218.3948974609375],[72.20455169677734,213.3948974609375],[73.20455169677734,211.3948974609375],[73.20455169677734,207.3948974609375],[73.20455169677734,204.3948974609375],[74.20455169677734,200.3948974609375],[74.20455169677734,198.3948974609375],[75.20455169677734,193.3948974609375],[75.20455169677734,191.3948974609375],[77.20455169677734,187.3948974609375],[78.20455169677734,180.3948974609375],[78.20455169677734,177.3948974609375],[79.20455169677734,174.3948974609375],[79.20455169677734,169.3948974609375],[81.20455169677734,165.3948974609375],[81.20455169677734,163.3948974609375],[82.20455169677734,158.3948974609375],[82.20455169677734,156.3948974609375],[83.20455169677734,153.3948974609375],[84.20455169677734,151.3948974609375],[84.20455169677734,148.3948974609375],[84.20455169677734,145.3948974609375],[84.20455169677734,141.3948974609375],[84.20455169677734,139.3948974609375],[85.20455169677734,135.3948974609375],[85.20455169677734,131.3948974609375],[85.20455169677734,128.3948974609375],[85.20455169677734,125.3948974609375],[85.20455169677734,122.3948974609375],[85.20455169677734,118.3948974609375],[84.20455169677734,116.3948974609375],[84.20455169677734,113.3948974609375],[81.20455169677734,108.3948974609375],[81.20455169677734,106.3948974609375],[79.20455169677734,101.3948974609375],[79.20455169677734,100.3948974609375],[79.20455169677734,98.3948974609375],[78.20455169677734,96.3948974609375],[75.20455169677734,92.3948974609375],[73.20455169677734,90.3948974609375],[73.20455169677734,89.3948974609375],[72.20455169677734,88.3948974609375],[72.20455169677734,87.3948974609375],[72.20455169677734,87.3948974609375]]\n            cone_blue = [[94.66,41.2],[127.86,29.6],[161.77,21.76],[194.2,18.39],[222.2,15.39],[248.2,15.39],[275.2,15.39],[311.89,19.53],[345.68,27.11],[378.3,44.3],[398.2,90.39],[394.4,126.94],[373.8,162.59],[333.75,185.59],[321.3,195.49],[310.35,209.47],[317.82,218.86],[325.28,221.25],[340.2,227.39],[372.5,240.92],[410.35,272.32],[423.2,311.39],[358.1,425.55],[327.28,435.54],[287.2,444.39],[255.2,447.39],[225.2,447.39],[196.2,447.39],[162.2,445.39],[123,431.99],[100.13,425.54],[27.2,310.39],[33.59,270.86],[39.14,242.37],[44.2,219.39],[48.73,188.1],[57.06,153.32],[59.01,128.85],[54.2,106.39]]\n            cone_yellow = [[107.75,93.59],[134.55,83.19],[170.64,75.03],[194.2,72.39],[222.2,69.39],[248.2,69.39],[275.2,69.39],[306.52,73.26],[326.72,77.68],[330.6,130.19],[320.66,133.2],[283.11,157.3],[262.06,185.32],[340.2,281.39],[361.91,293.87],[362.06,296.47],[369.2,311.39],[370.2,343.39],[365.06,356.32],[353.11,371.3],[330.31,379.24],[303.13,387.25],[287.2,390.39],[255.2,393.39],[225.2,393.39],[196.2,393.39],[162.2,391.39],[155.4,388.79],[124.28,377.25],[100.49,365.65],[84.3,349.3],[81.68,333.1],[81.2,310.39],[84.82,287.93],[89.27,262.42],[98.2,219.39],[101.68,198.69],[105.35,177.47],[111.4,141.94],[108.2,106.39]]\n            faulty_cones = []\n        `;*/\n        if (!(window as any).pyodide)\n            (window as any).pyodide = await loadPyodide({\n                indexURL: \"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/\",\n            });\n        if (!this.pyodide) this.pyodide = (window as any).pyodide as Await<ReturnType<typeof loadPyodide>>;\n\n        const code = await (await fetch(\"./python/main.py\")).text();\n\n        console.warn(\"BEFORE IMPORT\");\n        await this.pyodide.loadPackagesFromImports(code);\n        console.warn(\"AFTER IMPORT\");\n        this.pythonLoading = false;\n    }\n    d(p: [number, number], p2: [number, number]) {\n        return Math.sqrt(Math.pow(p[0] - p2[0], 2) + Math.pow(p[1] - p2[1], 2));\n    }\n    getPos(event: MouseEvent) {\n        var { x: offsetX, y: offsetY } = (event.target as HTMLCanvasElement).getBoundingClientRect();\n        var x = event.clientX - offsetX;\n        var y = event.clientY - offsetY;\n        return [x, y] as [number, number];\n    }\n    drawCircle(x: number, y: number, radius: number, fill: string) {\n        this.trackData.pylons.push({\n            x: Math.round(x * 100) / 100,\n            y: Math.round(y * 100) / 100,\n            color: fill,\n        });\n        this.drawCircleRaw(x, y, radius, fill);\n    }\n    drawCircleRaw(x: number, y: number, radius: number, fill: string) {\n        this.context.beginPath();\n        this.context.arc(x, y, radius, 0, 2 * Math.PI, false);\n        if (fill) {\n            this.context.fillStyle = fill;\n            this.context.fill();\n        }\n    }\n    drawArrow(from: readonly [number, number], offset: readonly [number, number], color: string) {\n        let to = plus(from, offset);\n        var headlen = 10; // length of head in pixels\n        var dx = to[0] - from[0];\n        var dy = to[1] - from[1];\n        var angle = Math.atan2(dy, dx);\n        this.context.beginPath();\n        this.context.moveTo(from[0], from[1]);\n        this.context.lineTo(to[0], to[1]);\n        this.context.lineTo(to[0] - headlen * Math.cos(angle - Math.PI / 6), to[1] - headlen * Math.sin(angle - Math.PI / 6));\n        this.context.moveTo(to[0], to[1]);\n        this.context.lineTo(to[0] - headlen * Math.cos(angle + Math.PI / 6), to[1] - headlen * Math.sin(angle + Math.PI / 6));\n        this.context.strokeStyle = color;\n        this.context.stroke();\n    }\n    reset() {\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.distance = 0;\n        this.nextDotTargetDistance = this.spacing;\n        this.trackData.pylons = [];\n        this.trackData.groundTruth = [];\n        this.detection = {};\n    }\n\n    private groundTruthToBeAdded = [] as [number, number][];\n    private freezeGroundTruth = false;\n\n    canvasMouseDown(event: MouseEvent) {\n        this.drawing = true;\n        this.lastPos = this.getPos(event);\n        this.groundTruthToBeAdded.push(this.lastPos.map((n) => Math.round(n * 100) / 100) as [number, number]);\n        this.startPos = this.lastPos;\n    }\n\n    canvasMouseMove(event: MouseEvent) {\n        if (!this.drawing) {\n            return;\n        }\n\n        var p = this.getPos(event);\n        this.groundTruthToBeAdded.push(p);\n\n        this.context.beginPath();\n        let distDelta = this.d(this.lastPos, p);\n        this.distance += distDelta;\n        this.context.moveTo(this.lastPos[0], this.lastPos[1]);\n        this.context.lineTo(p[0], p[1]);\n        this.context.stroke();\n\n        if (this.distance >= this.nextDotTargetDistance) {\n            this.nextDotTargetDistance += this.spacing;\n            let d = this.trackWidth / distDelta;\n            this.drawCircle(p[0] - (this.lastPos[1] - p[1]) * d, p[1] + (this.lastPos[0] - p[0]) * d, 5, \"#0000FF\");\n            this.drawCircle(p[0] + (this.lastPos[1] - p[1]) * d, p[1] - (this.lastPos[0] - p[0]) * d, 5, \"#FF0000\");\n        }\n        this.lastPos = p;\n    }\n    documentMouseup(event: MouseEvent) {\n        this.drawing = false;\n        var endPoint = this.getPos(event);\n        this.groundTruthToBeAdded.push(endPoint);\n\n        if (this.d(this.startPos, endPoint) < 5 && this.trackData.pylons.length > 0) {\n            //clicked\n            let closest = this.trackData.pylons.reduce((a, b) => (this.d([a.x, a.y], endPoint) < this.d([b.x, b.y], endPoint) ? a : b));\n\n            if (closest.undetect) {\n                closest.undetect = false;\n                closest.hidden = true;\n                this.drawCircleRaw(closest.x, closest.y, 5, \"#DDDDDD\");\n            } else if (closest.hidden) {\n                closest.undetect = false;\n                closest.hidden = false;\n                closest.color = \"#0000FF\";\n                this.drawCircleRaw(closest.x, closest.y, 5, closest.color);\n            } else if (closest.color == \"#0000FF\") {\n                closest.color = \"#FF0000\";\n                this.drawCircleRaw(closest.x, closest.y, 5, closest.color);\n            } else {\n                closest.undetect = true;\n                this.drawCircleRaw(closest.x, closest.y, 5, \"#000\");\n            }\n        } else {\n            //not clicked add collected ground truth\n            if (!this.freezeGroundTruth) this.trackData.groundTruth.push(...this.groundTruthToBeAdded);\n            this.groundTruthToBeAdded = [];\n        }\n    }\n\n    get output() {\n        let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n\n        return `\n            groundTruth = ${JSON.stringify(this.trackData.groundTruth)}\n            cone_blue = ${JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y]))}\n            cone_yellow = ${JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y]))}\n            faulty_cones = ${JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y]))}\n\n            ${this.detection.blueDetected ? `cone_blue_detected = ${JSON.stringify(this.detection.blueDetected)}` : \"\"}\n            ${this.detection.yellowDetected ? `cone_yellow_detected = ${JSON.stringify(this.detection.yellowDetected)}` : \"\"}\n            ${this.detection.midLine ? `midLine = ${JSON.stringify(this.detection.midLine)}` : \"\"}\n        `;\n    }\n    set output(value: string) {\n        try {\n            let entries = value\n                .split(\"\\n\")\n                .map((r) => r.trim())\n                .filter((l) => l)\n                .map((r) => r.split(\"=\"));\n            let map = Object.fromEntries(entries.map(([key, value]) => [key.trim(), JSON.parse(value)])) as {\n                groundTruth: [number, number][];\n                cone_blue: [number, number][];\n                cone_yellow: [number, number][];\n                faulty_cones: [number, number][];\n                cone_blue_detected?: [number, number][];\n                cone_yellow_detected?: [number, number][];\n                midLine?: [number, number][];\n            };\n\n            if (!map.cone_blue) map.cone_blue = [];\n            if (!map.cone_yellow) map.cone_yellow = [];\n            if (!map.faulty_cones) map.faulty_cones = [];\n\n            this.trackData.pylons = [\n                ...map.cone_blue.map(([x, y]) => ({ x, y, color: \"#0000FF\" })),\n                ...map.cone_yellow.map(([x, y]) => ({ x, y, color: \"#FF0000\" })),\n                ...map.faulty_cones.map(([x, y]) => ({ x, y, color: \"#000000\", undetect: true })),\n            ];\n            this.trackData.groundTruth = map.groundTruth;\n\n            this.detection = {\n                blueDetected: map.cone_blue_detected,\n                yellowDetected: map.cone_yellow_detected,\n                midLine: map.midLine,\n            };\n\n            this.outputError = \"\";\n            this.redraw();\n        } catch (e) {\n            this.outputError = \"\" + e;\n        }\n    }\n    addMissingPressed() {\n        let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n\n        let cone_blue = filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y] as [number, number]);\n        let cone_yellow = filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y] as [number, number]);\n        let faulty_cones = this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y] as [number, number]);\n\n        let deriveSpacing = (points: [number, number][]): number =>\n            points\n                .map((p, i, arr) => (arr[i + 1] ? d(p, arr[i + 1]) : 0))\n                .slice(0, -1)\n                .sort() //distances between consective points\n                .median(); //take the median as estimated for the generating distance\n        //derive spacing from map.cone_yellow, map.cone_blue\n        this.derivedSpacingBlue = deriveSpacing(cone_blue);\n\n        this.derivedSpacingRed = deriveSpacing(cone_yellow);\n\n        this.derivedWidth = [\n            ...cone_blue.map((point) => d(point, this.findClosestPoint(cone_yellow, point))),\n            ...cone_yellow.map((point) => d(point, this.findClosestPoint(cone_blue, point))),\n        ]\n            .sort()\n            .median();\n        //derive width from map.cone_blue-map.cone_yellow\n\n        this.addMissing(cone_yellow, cone_blue, this.derivedWidth, this.derivedSpacingRed, this.derivedSpacingBlue, \"#0000AA\", -1);\n        this.addMissing(cone_blue, cone_yellow, this.derivedWidth, this.derivedSpacingBlue, this.derivedSpacingRed, \"#AA0000\", 1);\n    }\n    private derivedWidth = 0;\n    private derivedSpacingRed = 0;\n    private derivedSpacingBlue = 0;\n\n    findClosestPoint(points: readonly [number, number][], point: readonly [number, number]): [number, number] {\n        return points.reduce((a, b) => (d([a[0], a[1]], point) < d([b[0], b[1]], point) ? a : b));\n    }\n    addMissing(\n        group1: [number, number][],\n        group2: [number, number][],\n        width: number,\n        spacing1: number,\n        spacing2: number,\n        color: string,\n        fac: number\n    ) {\n        for (let i = 1; i < group1.length - 1; i++) {\n            if (d(group1[i], group1[i + 1]) > spacing1 * 2) continue;\n            if (d(group1[i], group1[i - 1]) > spacing1 * 2) continue;\n\n            let n = rot(norm(plus(min(group1[i], group1[i + 1]), min(group1[i - 1], group1[i]))));\n            let add = plus(group1[i], mul(n, width * fac));\n\n            this.drawArrow(group1[i], mul(n, width * fac), \"pink\");\n            //this.drawArrow(group1[i], plus(min(group1[i], group1[i + 1]), min(group1[i - 1], group1[i])), \"green\");\n\n            let closest = this.findClosestPoint(group2, add);\n            if (d(add, closest) > spacing2 * 0.5) this.drawCircleRaw(add[0], add[1], 5, color);\n        }\n    }\n    download() {\n        var dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(this.trackData));\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var dlAnchorElem = document.getElementById(\"downloadAnchorElem\")!;\n        dlAnchorElem.setAttribute(\"href\", dataStr);\n        dlAnchorElem.setAttribute(\"download\", \"trackCones.json\");\n        dlAnchorElem.click();\n    }\n    private pythonLoading = true;\n    async calculatePython() {\n        if (this.pythonLoading || this.pyodide == null) return;\n        this.pythonLoading = true;\n\n        try {\n            let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n            /* const data = await (\n            await fetch(\n                \"http://localhost:3000?\" +\n                    new URLSearchParams({\n                        b: JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y])),\n                        y: JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y])),\n                        f: JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y])),\n                    })\n            )\n        ).text();*/\n            this.pyodide.globals.set(\"args\", {\n                cone_blue: JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y])),\n                cone_yellow: JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y])),\n                faulty_cones: JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y])),\n            });\n            await this.pyodide.runPythonAsync(\"print(args)\");\n\n            await this.pyodide.runPythonAsync(`\n            import sys\n            from js import fetch\n            async def fetch_and_decode(url):\n                jsbuf = await (await fetch(url)).arrayBuffer()\n                pybuf = bytearray(jsbuf.to_py())\n                return pybuf\n\n            with open('christofides.py', 'wb') as f:\n                f.write(await fetch_and_decode(\"./python/christofides.py\"))\n            sys.path.insert(0, '.')\n        `);\n            console.warn(\"AFTER CODE1\");\n            const code = await (await fetch(\"./python/main.py\")).text();\n            console.log(await this.pyodide.runPythonAsync(\"__name__='__main__'\\n\" + code));\n            console.warn(\"AFTER CODE2\");\n            const [blueDetected, yellowDetected, midLine] = this.pyodide.globals.get(\"result\").toJs();\n            this.output += `\n            cone_blue_detected = ${JSON.stringify(blueDetected)}\n            cone_yellow_detected = ${JSON.stringify(yellowDetected)}\n            midLine = ${JSON.stringify(midLine)}`;\n        } catch (e) {\n            console.warn(e);\n        } finally {\n            this.pythonLoading = false;\n        }\n    }\n\n    async openDemo(fileName: string) {\n        this.reset();\n        const text = await (await fetch(fileName)).text();\n        let result = YAML.parse(text) as YAMLFile;\n        this.loadYAMLFile(result);\n    }\n    async YAMLFilesChange(event: Event) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var files = (event.target as HTMLInputElement).files!;\n        console.log(files);\n        let result = YAML.parse(await files[0].text()) as YAMLFile;\n        this.loadYAMLFile(result);\n    }\n    loadYAMLFile(result: YAMLFile) {\n        const { cones_left, cones_orange, cones_orange_big, cones_right } = result;\n\n        console.log([cones_left, cones_orange, cones_orange_big, cones_right]);\n\n        const parsedSets = [cones_left, cones_orange, cones_orange_big, cones_right].map((list) =>\n            list.map((p) => p.split(\"\\n\").map((x) => parseFloat(x.trim().slice(1))))\n        ); //parse numbers\n\n        const list = parsedSets.flat();\n        //normalize\n        const [minX, maxX] = [list.map((p) => p[0]).min(), list.map((p) => p[0]).max()];\n        const [minY, maxY] = [list.map((p) => p[1]).min(), list.map((p) => p[1]).max()];\n        //const scale = Math.min(1 / (maxX - minX), 1 / (maxY - minY));\n        const scale = Math.min(1 / (maxX - minX), 1 / (maxY - minY));\n        const offset = [-minX, -minY] as const;\n\n        const trackSets = parsedSets\n            .map((list) => {\n                return list.map((p) => mul(plus(p as [number, number], offset), scale));\n            }) //scale to 500x500 with padding\n            .map((list) =>\n                list.map((p) => plus(mul(p as [number, number], 450).map((x) => Math.round(x * 100) / 100) as [number, number], [25, 25]))\n            );\n\n        trackSets.forEach((list, i) =>\n            list.forEach((p) => {\n                this.drawCircleRaw(p[0], p[1], 5, [\"blue\", \"yellow\", \"orange\", \"red\", \"green\"][i]);\n            })\n        );\n        this.trackData.pylons = [\n            ...trackSets[0].map(([x, y]) => ({ x, y, color: \"#0000FF\" })),\n            ...trackSets[3].map(([x, y]) => ({ x, y, color: \"#FF0000\" })),\n        ];\n    }\n\n    async JSONFilesChange(event: Event) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var files = (event.target as HTMLInputElement).files!;\n        console.log(files);\n        let result = JSON.parse(await files[0].text()) as Track;\n        this.reset();\n        this.trackData = result;\n        this.redraw();\n    }\n    redraw() {\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        this.trackData.pylons.forEach(({ x, y, color, hidden, undetect }) =>\n            this.drawCircleRaw(x, y, 5, hidden ? \"#DDDDDD\" : undetect ? \"#000\" : color)\n        );\n\n        this.strokePolygon(this.detection.blueDetected || [], \"#7777FF\", 3, true, true);\n        this.strokePolygon(this.detection.yellowDetected || [], \"#FF7777\", 3, true, true);\n        this.strokePolygon(this.detection.midLine || [], \"#00FF00\", 5, true, true);\n\n        this.strokePolygon(this.trackData.groundTruth, \"#000000\", 3, true, false);\n    }\n    strokePolygon(pointsArray: [number, number][], strokeColor: string, radius: number, stroke?: boolean, circles?: boolean) {\n        if (pointsArray.length <= 0) return;\n        this.context.beginPath();\n\n        if (strokeColor) this.context.strokeStyle = strokeColor;\n        if (stroke)\n            for (let i = 0; i < pointsArray.length - 1; i++) {\n                this.drawArrow(pointsArray[i], min(pointsArray[i + 1], pointsArray[i]), strokeColor);\n                //this.context.lineTo(pointsArray[i][0] * scale + offset, pointsArray[i][1] * scale + offset);\n            }\n        this.context.stroke();\n        if (circles)\n            for (let i = 0; i < pointsArray.length; i++) {\n                this.drawCircle(pointsArray[i][0], pointsArray[i][1], radius, strokeColor);\n            }\n    }\n}\n\nfunction d(p: readonly [number, number], p2: readonly [number, number]) {\n    return Math.sqrt(Math.pow(p[0] - p2[0], 2) + Math.pow(p[1] - p2[1], 2));\n}\nfunction plus(p: readonly [number, number], p2: readonly [number, number]) {\n    return [p[0] + p2[0], p[1] + p2[1]] as const;\n}\nfunction min(p: readonly [number, number], p2: readonly [number, number]) {\n    return [p[0] - p2[0], p[1] - p2[1]] as const;\n}\nfunction mul(p: readonly [number, number], p2: number | [number, number]): readonly [number, number] {\n    if (typeof p2 == \"number\") return [p[0] * p2, p[1] * p2] as const;\n    return [p[0] * p2[0], p[1] * p2[1]] as const;\n}\nfunction norm(p: readonly [number, number]) {\n    return mul(p, 1 / d(p, [0, 0]));\n}\nfunction rot(p: readonly [number, number]) {\n    return [p[1], -p[0]] as const;\n}\n\ndeclare global {\n    interface Array<T> {\n        median(): T;\n        mean(): T;\n        max(): T;\n        min(): T;\n    }\n}\n\nArray.prototype.median = function <T>(this: T[]): T {\n    if (this.length == 0) throw new Error(\"Array.median invoced with empty array\");\n    if (this.length % 2 === 0) {\n        let a = this[this.length / 2 - 1];\n        let b = this[this.length / 2 - 1];\n        if (typeof a != \"number\" || typeof b != \"number\") throw new Error(\"median values non numeric in array with even size\");\n        // Average Of Two Middle Numbers\n        return ((a + b) / 2) as unknown as T;\n    }\n    return this[(this.length - 1) / 2];\n};\nArray.prototype.mean = function (this: number[]): number {\n    var num = 0;\n    for (var i = 0, l = this.length; i < l; i++) num += this[i];\n    return num / this.length;\n};\nArray.prototype.max = function () {\n    return Math.max.apply(null, this);\n};\n\nArray.prototype.min = function () {\n    return Math.min.apply(null, this);\n};\n</script>\n\n<style l>\ncanvas {\n    box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);\n    cursor: crosshair;\n}\ninput[type=\"range\"][disabled].handle-red::-webkit-slider-thumb {\n    background: #ad6868 !important;\n}\ninput[type=\"range\"][disabled].handle-blue::-webkit-slider-thumb {\n    background: #6161b6 !important;\n}\n</style>\n","\ninterface Pylon {\n    x: number;\n    y: number;\n    color: string;\n    hidden?: boolean;\n    undetect?: boolean;\n}\ninterface Track {\n    pylons: Pylon[];\n    groundTruth: [number, number][];\n}\ninterface Detection {\n    blueDetected?: [number, number][];\n    yellowDetected?: [number, number][];\n    midLine?: [number, number][];\n}\n\ninterface YAMLFile {\n    cones_left: string[];\n    cones_orange: string[];\n    cones_orange_big: string[];\n    cones_right: string[];\n    middle_points: string[];\n    starting_pose_front_wing: number[];\n    tk_device: string[];\n}\n\n/**\n * NOTES:\n * do the AI stuff with perceptilabs.com/papers\n */\nimport { Options, Vue } from \"vue-class-component\";\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n//@ts-ignore\nimport * as YAML from \"yamljs\";\ndeclare let loadPyodide: (opt: { indexURL: string }) => Promise<{\n    runPython: (code: string) => any;\n    runPythonAsync: (code: string) => any;\n    loadPackagesFromImports: (code: string) => any;\n    globals: {\n        get: (key: \"result\") => {\n            toJs: () => any;\n        };\n        set: (key: \"args\", value: any) => void;\n    };\n}>;\ntype Await<T> = T extends PromiseLike<infer U> ? U : T;\n\n@Options({})\nexport default class TrackCanvas extends Vue {\n    private spacing = 30;\n    private trackWidth = 10;\n\n    private drawing = false;\n    private lastPos = [0, 0] as [number, number];\n    private startPos = [0, 0] as [number, number];\n\n    private distance = 0;\n    private nextDotTargetDistance = this.spacing;\n    private trackData = { pylons: [], groundTruth: [] } as Track;\n    private detection = {} as Detection;\n\n    private outputError = \"\";\n\n    get context() {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return this.canvas.getContext(\"2d\")!;\n    }\n    get canvas() {\n        return this.$refs.canvas as HTMLCanvasElement;\n    }\n\n    private pyodide = null as Await<ReturnType<typeof loadPyodide>> | null;\n    async mounted() {\n        /*this.output = `\n            groundTruth = [[78.2,87.39],[78.20455169677734,83.3948974609375],[83.20455169677734,78.3948974609375],[89.20455169677734,73.3948974609375],[93.20455169677734,71.3948974609375],[97.20455169677734,68.3948974609375],[101.20455169677734,67.3948974609375],[109.20455169677734,62.3948974609375],[116.20455169677734,59.3948974609375],[123.20455169677734,57.3948974609375],[131.20455169677734,56.3948974609375],[136.20455169677734,53.3948974609375],[144.20455169677734,52.3948974609375],[154.20455169677734,50.3948974609375],[166.20455169677734,48.3948974609375],[174.20455169677734,46.3948974609375],[182.20455169677734,45.3948974609375],[194.20455169677734,45.3948974609375],[202.20455169677734,43.3948974609375],[214.20455169677734,42.3948974609375],[222.20455169677734,42.3948974609375],[229.20455169677734,42.3948974609375],[238.20455169677734,42.3948974609375],[248.20455169677734,42.3948974609375],[255.20455169677734,42.3948974609375],[259.20455169677734,42.3948974609375],[267.20455169677734,42.3948974609375],[275.20455169677734,42.3948974609375],[283.20455169677734,42.3948974609375],[288.20455169677734,42.3948974609375],[295.20455169677734,43.3948974609375],[299.20455169677734,45.3948974609375],[309.20455169677734,46.3948974609375],[316.20455169677734,47.3948974609375],[321.20455169677734,49.3948974609375],[328.20455169677734,49.3948974609375],[336.20455169677734,52.3948974609375],[340.20455169677734,53.3948974609375],[347.20455169677734,56.3948974609375],[351.20455169677734,57.3948974609375],[353.20455169677734,57.3948974609375],[355.20455169677734,61.3948974609375],[357.20455169677734,61.3948974609375],[359.20455169677734,63.3948974609375],[361.20455169677734,66.3948974609375],[362.20455169677734,67.3948974609375],[364.20455169677734,70.3948974609375],[366.20455169677734,74.3948974609375],[367.20455169677734,77.3948974609375],[368.20455169677734,82.3948974609375],[368.20455169677734,85.3948974609375],[371.20455169677734,88.3948974609375],[371.20455169677734,90.3948974609375],[371.20455169677734,93.3948974609375],[371.20455169677734,98.3948974609375],[371.20455169677734,99.3948974609375],[371.20455169677734,104.3948974609375],[370.20455169677734,108.3948974609375],[369.20455169677734,111.3948974609375],[369.20455169677734,116.3948974609375],[368.20455169677734,120.3948974609375],[366.20455169677734,125.3948974609375],[365.20455169677734,127.3948974609375],[364.20455169677734,128.3948974609375],[362.20455169677734,133.3948974609375],[359.20455169677734,138.3948974609375],[358.20455169677734,140.3948974609375],[355.20455169677734,142.3948974609375],[352.20455169677734,146.3948974609375],[350.20455169677734,147.3948974609375],[348.20455169677734,148.3948974609375],[346.20455169677734,149.3948974609375],[343.20455169677734,152.3948974609375],[339.20455169677734,154.3948974609375],[335.20455169677734,155.3948974609375],[333.20455169677734,157.3948974609375],[331.20455169677734,158.3948974609375],[327.20455169677734,159.3948974609375],[323.20455169677734,161.3948974609375],[318.20455169677734,164.3948974609375],[315.20455169677734,168.3948974609375],[313.20455169677734,168.3948974609375],[311.20455169677734,169.3948974609375],[307.20455169677734,171.3948974609375],[306.20455169677734,171.3948974609375],[304.20455169677734,174.3948974609375],[302.20455169677734,176.3948974609375],[299.20455169677734,177.3948974609375],[298.20455169677734,178.3948974609375],[296.20455169677734,179.3948974609375],[295.20455169677734,180.3948974609375],[293.20455169677734,182.3948974609375],[291.20455169677734,184.3948974609375],[290.20455169677734,185.3948974609375],[289.20455169677734,186.3948974609375],[289.20455169677734,188.3948974609375],[288.20455169677734,189.3948974609375],[287.20455169677734,193.3948974609375],[287.20455169677734,195.3948974609375],[286.20455169677734,197.3948974609375],[286.20455169677734,198.3948974609375],[286.20455169677734,200.3948974609375],[286.20455169677734,204.3948974609375],[286.20455169677734,206.3948974609375],[286.20455169677734,208.3948974609375],[286.20455169677734,212.3948974609375],[287.20455169677734,214.3948974609375],[287.20455169677734,216.3948974609375],[289.20455169677734,218.3948974609375],[289.20455169677734,219.3948974609375],[290.20455169677734,222.3948974609375],[291.20455169677734,224.3948974609375],[292.20455169677734,227.3948974609375],[294.20455169677734,228.3948974609375],[295.20455169677734,230.3948974609375],[297.20455169677734,231.3948974609375],[298.20455169677734,232.3948974609375],[299.20455169677734,234.3948974609375],[300.20455169677734,236.3948974609375],[301.20455169677734,237.3948974609375],[302.20455169677734,238.3948974609375],[304.20455169677734,239.3948974609375],[306.20455169677734,240.3948974609375],[307.20455169677734,241.3948974609375],[308.20455169677734,243.3948974609375],[310.20455169677734,243.3948974609375],[311.20455169677734,244.3948974609375],[313.20455169677734,245.3948974609375],[315.20455169677734,246.3948974609375],[317.20455169677734,247.3948974609375],[318.20455169677734,247.3948974609375],[321.20455169677734,249.3948974609375],[323.20455169677734,250.3948974609375],[325.20455169677734,250.3948974609375],[328.20455169677734,251.3948974609375],[330.20455169677734,252.3948974609375],[334.20455169677734,252.3948974609375],[337.20455169677734,254.3948974609375],[338.20455169677734,254.3948974609375],[340.20455169677734,254.3948974609375],[342.20455169677734,257.3948974609375],[345.20455169677734,257.3948974609375],[348.20455169677734,258.3948974609375],[350.20455169677734,260.3948974609375],[354.20455169677734,260.3948974609375],[358.20455169677734,263.3948974609375],[360.20455169677734,265.3948974609375],[362.20455169677734,266.3948974609375],[367.20455169677734,267.3948974609375],[370.20455169677734,272.3948974609375],[372.20455169677734,272.3948974609375],[375.20455169677734,274.3948974609375],[377.20455169677734,276.3948974609375],[378.20455169677734,278.3948974609375],[380.20455169677734,278.3948974609375],[382.20455169677734,280.3948974609375],[385.20455169677734,282.3948974609375],[386.20455169677734,284.3948974609375],[387.20455169677734,287.3948974609375],[388.20455169677734,288.3948974609375],[389.20455169677734,290.3948974609375],[390.20455169677734,292.3948974609375],[390.20455169677734,293.3948974609375],[393.20455169677734,296.3948974609375],[393.20455169677734,297.3948974609375],[394.20455169677734,298.3948974609375],[395.20455169677734,300.3948974609375],[395.20455169677734,303.3948974609375],[396.20455169677734,305.3948974609375],[396.20455169677734,307.3948974609375],[396.20455169677734,311.3948974609375],[397.20455169677734,311.3948974609375],[397.20455169677734,316.3948974609375],[397.20455169677734,317.3948974609375],[397.20455169677734,322.3948974609375],[397.20455169677734,326.3948974609375],[397.20455169677734,329.3948974609375],[397.20455169677734,334.3948974609375],[397.20455169677734,337.3948974609375],[397.20455169677734,339.3948974609375],[397.20455169677734,343.3948974609375],[397.20455169677734,346.3948974609375],[397.20455169677734,347.3948974609375],[397.20455169677734,348.3948974609375],[396.20455169677734,354.3948974609375],[395.20455169677734,356.3948974609375],[395.20455169677734,357.3948974609375],[395.20455169677734,358.3948974609375],[393.20455169677734,360.3948974609375],[392.20455169677734,362.3948974609375],[391.20455169677734,364.3948974609375],[389.20455169677734,368.3948974609375],[388.20455169677734,369.3948974609375],[387.20455169677734,373.3948974609375],[386.20455169677734,375.3948974609375],[384.20455169677734,377.3948974609375],[382.20455169677734,378.3948974609375],[381.20455169677734,381.3948974609375],[378.20455169677734,383.3948974609375],[378.20455169677734,385.3948974609375],[376.20455169677734,386.3948974609375],[374.20455169677734,388.3948974609375],[372.20455169677734,390.3948974609375],[368.20455169677734,391.3948974609375],[365.20455169677734,392.3948974609375],[360.20455169677734,395.3948974609375],[358.20455169677734,396.3948974609375],[356.20455169677734,398.3948974609375],[352.20455169677734,398.3948974609375],[349.20455169677734,399.3948974609375],[344.20455169677734,402.3948974609375],[341.20455169677734,403.3948974609375],[338.20455169677734,404.3948974609375],[334.20455169677734,406.3948974609375],[329.20455169677734,407.3948974609375],[326.20455169677734,408.3948974609375],[321.20455169677734,408.3948974609375],[319.20455169677734,409.3948974609375],[315.20455169677734,411.3948974609375],[312.20455169677734,412.3948974609375],[306.20455169677734,413.3948974609375],[304.20455169677734,413.3948974609375],[302.20455169677734,414.3948974609375],[298.20455169677734,415.3948974609375],[293.20455169677734,417.3948974609375],[287.20455169677734,417.3948974609375],[284.20455169677734,418.3948974609375],[279.20455169677734,418.3948974609375],[275.20455169677734,418.3948974609375],[270.20455169677734,419.3948974609375],[268.20455169677734,419.3948974609375],[263.20455169677734,420.3948974609375],[255.20455169677734,420.3948974609375],[252.20455169677734,420.3948974609375],[245.20455169677734,420.3948974609375],[239.20455169677734,420.3948974609375],[232.20455169677734,420.3948974609375],[225.20455169677734,420.3948974609375],[217.20455169677734,420.3948974609375],[214.20455169677734,420.3948974609375],[208.20455169677734,420.3948974609375],[202.20455169677734,420.3948974609375],[196.20455169677734,420.3948974609375],[191.20455169677734,420.3948974609375],[188.20455169677734,420.3948974609375],[185.20455169677734,420.3948974609375],[181.20455169677734,420.3948974609375],[173.20455169677734,420.3948974609375],[169.20455169677734,418.3948974609375],[162.20455169677734,418.3948974609375],[156.20455169677734,417.3948974609375],[151.20455169677734,416.3948974609375],[143.20455169677734,413.3948974609375],[139.20455169677734,410.3948974609375],[129.20455169677734,408.3948974609375],[125.20455169677734,407.3948974609375],[118.20455169677734,404.3948974609375],[112.20455169677734,401.3948974609375],[106.20455169677734,398.3948974609375],[99.20455169677734,398.3948974609375],[98.20455169677734,396.3948974609375],[92.20455169677734,393.3948974609375],[89.20455169677734,391.3948974609375],[83.20455169677734,386.3948974609375],[79.20455169677734,384.3948974609375],[77.20455169677734,380.3948974609375],[71.20455169677734,377.3948974609375],[68.20455169677734,371.3948974609375],[65.20455169677734,368.3948974609375],[63.204551696777344,365.3948974609375],[60.204551696777344,358.3948974609375],[59.204551696777344,352.3948974609375],[57.204551696777344,347.3948974609375],[56.204551696777344,343.3948974609375],[55.204551696777344,338.3948974609375],[55.204551696777344,333.3948974609375],[54.204551696777344,328.3948974609375],[54.204551696777344,324.3948974609375],[54.204551696777344,319.3948974609375],[54.204551696777344,315.3948974609375],[54.204551696777344,310.3948974609375],[54.204551696777344,307.3948974609375],[54.204551696777344,302.3948974609375],[54.204551696777344,297.3948974609375],[55.204551696777344,290.3948974609375],[56.204551696777344,286.3948974609375],[58.204551696777344,282.3948974609375],[59.204551696777344,279.3948974609375],[59.204551696777344,275.3948974609375],[59.204551696777344,273.3948974609375],[59.204551696777344,268.3948974609375],[60.204551696777344,264.3948974609375],[62.204551696777344,259.3948974609375],[62.204551696777344,257.3948974609375],[64.20455169677734,252.3948974609375],[64.20455169677734,248.3948974609375],[65.20455169677734,243.3948974609375],[67.20455169677734,238.3948974609375],[69.20455169677734,232.3948974609375],[70.20455169677734,228.3948974609375],[71.20455169677734,226.3948974609375],[71.20455169677734,224.3948974609375],[71.20455169677734,219.3948974609375],[71.20455169677734,218.3948974609375],[72.20455169677734,213.3948974609375],[73.20455169677734,211.3948974609375],[73.20455169677734,207.3948974609375],[73.20455169677734,204.3948974609375],[74.20455169677734,200.3948974609375],[74.20455169677734,198.3948974609375],[75.20455169677734,193.3948974609375],[75.20455169677734,191.3948974609375],[77.20455169677734,187.3948974609375],[78.20455169677734,180.3948974609375],[78.20455169677734,177.3948974609375],[79.20455169677734,174.3948974609375],[79.20455169677734,169.3948974609375],[81.20455169677734,165.3948974609375],[81.20455169677734,163.3948974609375],[82.20455169677734,158.3948974609375],[82.20455169677734,156.3948974609375],[83.20455169677734,153.3948974609375],[84.20455169677734,151.3948974609375],[84.20455169677734,148.3948974609375],[84.20455169677734,145.3948974609375],[84.20455169677734,141.3948974609375],[84.20455169677734,139.3948974609375],[85.20455169677734,135.3948974609375],[85.20455169677734,131.3948974609375],[85.20455169677734,128.3948974609375],[85.20455169677734,125.3948974609375],[85.20455169677734,122.3948974609375],[85.20455169677734,118.3948974609375],[84.20455169677734,116.3948974609375],[84.20455169677734,113.3948974609375],[81.20455169677734,108.3948974609375],[81.20455169677734,106.3948974609375],[79.20455169677734,101.3948974609375],[79.20455169677734,100.3948974609375],[79.20455169677734,98.3948974609375],[78.20455169677734,96.3948974609375],[75.20455169677734,92.3948974609375],[73.20455169677734,90.3948974609375],[73.20455169677734,89.3948974609375],[72.20455169677734,88.3948974609375],[72.20455169677734,87.3948974609375],[72.20455169677734,87.3948974609375]]\n            cone_blue = [[94.66,41.2],[127.86,29.6],[161.77,21.76],[194.2,18.39],[222.2,15.39],[248.2,15.39],[275.2,15.39],[311.89,19.53],[345.68,27.11],[378.3,44.3],[398.2,90.39],[394.4,126.94],[373.8,162.59],[333.75,185.59],[321.3,195.49],[310.35,209.47],[317.82,218.86],[325.28,221.25],[340.2,227.39],[372.5,240.92],[410.35,272.32],[423.2,311.39],[358.1,425.55],[327.28,435.54],[287.2,444.39],[255.2,447.39],[225.2,447.39],[196.2,447.39],[162.2,445.39],[123,431.99],[100.13,425.54],[27.2,310.39],[33.59,270.86],[39.14,242.37],[44.2,219.39],[48.73,188.1],[57.06,153.32],[59.01,128.85],[54.2,106.39]]\n            cone_yellow = [[107.75,93.59],[134.55,83.19],[170.64,75.03],[194.2,72.39],[222.2,69.39],[248.2,69.39],[275.2,69.39],[306.52,73.26],[326.72,77.68],[330.6,130.19],[320.66,133.2],[283.11,157.3],[262.06,185.32],[340.2,281.39],[361.91,293.87],[362.06,296.47],[369.2,311.39],[370.2,343.39],[365.06,356.32],[353.11,371.3],[330.31,379.24],[303.13,387.25],[287.2,390.39],[255.2,393.39],[225.2,393.39],[196.2,393.39],[162.2,391.39],[155.4,388.79],[124.28,377.25],[100.49,365.65],[84.3,349.3],[81.68,333.1],[81.2,310.39],[84.82,287.93],[89.27,262.42],[98.2,219.39],[101.68,198.69],[105.35,177.47],[111.4,141.94],[108.2,106.39]]\n            faulty_cones = []\n        `;*/\n        if (!(window as any).pyodide)\n            (window as any).pyodide = await loadPyodide({\n                indexURL: \"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/\",\n            });\n        if (!this.pyodide) this.pyodide = (window as any).pyodide as Await<ReturnType<typeof loadPyodide>>;\n\n        const code = await (await fetch(\"./python/main.py\")).text();\n\n        console.warn(\"BEFORE IMPORT\");\n        await this.pyodide.loadPackagesFromImports(code);\n        console.warn(\"AFTER IMPORT\");\n        this.pythonLoading = false;\n    }\n    d(p: [number, number], p2: [number, number]) {\n        return Math.sqrt(Math.pow(p[0] - p2[0], 2) + Math.pow(p[1] - p2[1], 2));\n    }\n    getPos(event: MouseEvent) {\n        var { x: offsetX, y: offsetY } = (event.target as HTMLCanvasElement).getBoundingClientRect();\n        var x = event.clientX - offsetX;\n        var y = event.clientY - offsetY;\n        return [x, y] as [number, number];\n    }\n    drawCircle(x: number, y: number, radius: number, fill: string) {\n        this.trackData.pylons.push({\n            x: Math.round(x * 100) / 100,\n            y: Math.round(y * 100) / 100,\n            color: fill,\n        });\n        this.drawCircleRaw(x, y, radius, fill);\n    }\n    drawCircleRaw(x: number, y: number, radius: number, fill: string) {\n        this.context.beginPath();\n        this.context.arc(x, y, radius, 0, 2 * Math.PI, false);\n        if (fill) {\n            this.context.fillStyle = fill;\n            this.context.fill();\n        }\n    }\n    drawArrow(from: readonly [number, number], offset: readonly [number, number], color: string) {\n        let to = plus(from, offset);\n        var headlen = 10; // length of head in pixels\n        var dx = to[0] - from[0];\n        var dy = to[1] - from[1];\n        var angle = Math.atan2(dy, dx);\n        this.context.beginPath();\n        this.context.moveTo(from[0], from[1]);\n        this.context.lineTo(to[0], to[1]);\n        this.context.lineTo(to[0] - headlen * Math.cos(angle - Math.PI / 6), to[1] - headlen * Math.sin(angle - Math.PI / 6));\n        this.context.moveTo(to[0], to[1]);\n        this.context.lineTo(to[0] - headlen * Math.cos(angle + Math.PI / 6), to[1] - headlen * Math.sin(angle + Math.PI / 6));\n        this.context.strokeStyle = color;\n        this.context.stroke();\n    }\n    reset() {\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.distance = 0;\n        this.nextDotTargetDistance = this.spacing;\n        this.trackData.pylons = [];\n        this.trackData.groundTruth = [];\n        this.detection = {};\n    }\n\n    private groundTruthToBeAdded = [] as [number, number][];\n    private freezeGroundTruth = false;\n\n    canvasMouseDown(event: MouseEvent) {\n        this.drawing = true;\n        this.lastPos = this.getPos(event);\n        this.groundTruthToBeAdded.push(this.lastPos.map((n) => Math.round(n * 100) / 100) as [number, number]);\n        this.startPos = this.lastPos;\n    }\n\n    canvasMouseMove(event: MouseEvent) {\n        if (!this.drawing) {\n            return;\n        }\n\n        var p = this.getPos(event);\n        this.groundTruthToBeAdded.push(p);\n\n        this.context.beginPath();\n        let distDelta = this.d(this.lastPos, p);\n        this.distance += distDelta;\n        this.context.moveTo(this.lastPos[0], this.lastPos[1]);\n        this.context.lineTo(p[0], p[1]);\n        this.context.stroke();\n\n        if (this.distance >= this.nextDotTargetDistance) {\n            this.nextDotTargetDistance += this.spacing;\n            let d = this.trackWidth / distDelta;\n            this.drawCircle(p[0] - (this.lastPos[1] - p[1]) * d, p[1] + (this.lastPos[0] - p[0]) * d, 5, \"#0000FF\");\n            this.drawCircle(p[0] + (this.lastPos[1] - p[1]) * d, p[1] - (this.lastPos[0] - p[0]) * d, 5, \"#FF0000\");\n        }\n        this.lastPos = p;\n    }\n    documentMouseup(event: MouseEvent) {\n        this.drawing = false;\n        var endPoint = this.getPos(event);\n        this.groundTruthToBeAdded.push(endPoint);\n\n        if (this.d(this.startPos, endPoint) < 5 && this.trackData.pylons.length > 0) {\n            //clicked\n            let closest = this.trackData.pylons.reduce((a, b) => (this.d([a.x, a.y], endPoint) < this.d([b.x, b.y], endPoint) ? a : b));\n\n            if (closest.undetect) {\n                closest.undetect = false;\n                closest.hidden = true;\n                this.drawCircleRaw(closest.x, closest.y, 5, \"#DDDDDD\");\n            } else if (closest.hidden) {\n                closest.undetect = false;\n                closest.hidden = false;\n                closest.color = \"#0000FF\";\n                this.drawCircleRaw(closest.x, closest.y, 5, closest.color);\n            } else if (closest.color == \"#0000FF\") {\n                closest.color = \"#FF0000\";\n                this.drawCircleRaw(closest.x, closest.y, 5, closest.color);\n            } else {\n                closest.undetect = true;\n                this.drawCircleRaw(closest.x, closest.y, 5, \"#000\");\n            }\n        } else {\n            //not clicked add collected ground truth\n            if (!this.freezeGroundTruth) this.trackData.groundTruth.push(...this.groundTruthToBeAdded);\n            this.groundTruthToBeAdded = [];\n        }\n    }\n\n    get output() {\n        let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n\n        return `\n            groundTruth = ${JSON.stringify(this.trackData.groundTruth)}\n            cone_blue = ${JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y]))}\n            cone_yellow = ${JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y]))}\n            faulty_cones = ${JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y]))}\n\n            ${this.detection.blueDetected ? `cone_blue_detected = ${JSON.stringify(this.detection.blueDetected)}` : \"\"}\n            ${this.detection.yellowDetected ? `cone_yellow_detected = ${JSON.stringify(this.detection.yellowDetected)}` : \"\"}\n            ${this.detection.midLine ? `midLine = ${JSON.stringify(this.detection.midLine)}` : \"\"}\n        `;\n    }\n    set output(value: string) {\n        try {\n            let entries = value\n                .split(\"\\n\")\n                .map((r) => r.trim())\n                .filter((l) => l)\n                .map((r) => r.split(\"=\"));\n            let map = Object.fromEntries(entries.map(([key, value]) => [key.trim(), JSON.parse(value)])) as {\n                groundTruth: [number, number][];\n                cone_blue: [number, number][];\n                cone_yellow: [number, number][];\n                faulty_cones: [number, number][];\n                cone_blue_detected?: [number, number][];\n                cone_yellow_detected?: [number, number][];\n                midLine?: [number, number][];\n            };\n\n            if (!map.cone_blue) map.cone_blue = [];\n            if (!map.cone_yellow) map.cone_yellow = [];\n            if (!map.faulty_cones) map.faulty_cones = [];\n\n            this.trackData.pylons = [\n                ...map.cone_blue.map(([x, y]) => ({ x, y, color: \"#0000FF\" })),\n                ...map.cone_yellow.map(([x, y]) => ({ x, y, color: \"#FF0000\" })),\n                ...map.faulty_cones.map(([x, y]) => ({ x, y, color: \"#000000\", undetect: true })),\n            ];\n            this.trackData.groundTruth = map.groundTruth;\n\n            this.detection = {\n                blueDetected: map.cone_blue_detected,\n                yellowDetected: map.cone_yellow_detected,\n                midLine: map.midLine,\n            };\n\n            this.outputError = \"\";\n            this.redraw();\n        } catch (e) {\n            this.outputError = \"\" + e;\n        }\n    }\n    addMissingPressed() {\n        let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n\n        let cone_blue = filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y] as [number, number]);\n        let cone_yellow = filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y] as [number, number]);\n        let faulty_cones = this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y] as [number, number]);\n\n        let deriveSpacing = (points: [number, number][]): number =>\n            points\n                .map((p, i, arr) => (arr[i + 1] ? d(p, arr[i + 1]) : 0))\n                .slice(0, -1)\n                .sort() //distances between consective points\n                .median(); //take the median as estimated for the generating distance\n        //derive spacing from map.cone_yellow, map.cone_blue\n        this.derivedSpacingBlue = deriveSpacing(cone_blue);\n\n        this.derivedSpacingRed = deriveSpacing(cone_yellow);\n\n        this.derivedWidth = [\n            ...cone_blue.map((point) => d(point, this.findClosestPoint(cone_yellow, point))),\n            ...cone_yellow.map((point) => d(point, this.findClosestPoint(cone_blue, point))),\n        ]\n            .sort()\n            .median();\n        //derive width from map.cone_blue-map.cone_yellow\n\n        this.addMissing(cone_yellow, cone_blue, this.derivedWidth, this.derivedSpacingRed, this.derivedSpacingBlue, \"#0000AA\", -1);\n        this.addMissing(cone_blue, cone_yellow, this.derivedWidth, this.derivedSpacingBlue, this.derivedSpacingRed, \"#AA0000\", 1);\n    }\n    private derivedWidth = 0;\n    private derivedSpacingRed = 0;\n    private derivedSpacingBlue = 0;\n\n    findClosestPoint(points: readonly [number, number][], point: readonly [number, number]): [number, number] {\n        return points.reduce((a, b) => (d([a[0], a[1]], point) < d([b[0], b[1]], point) ? a : b));\n    }\n    addMissing(\n        group1: [number, number][],\n        group2: [number, number][],\n        width: number,\n        spacing1: number,\n        spacing2: number,\n        color: string,\n        fac: number\n    ) {\n        for (let i = 1; i < group1.length - 1; i++) {\n            if (d(group1[i], group1[i + 1]) > spacing1 * 2) continue;\n            if (d(group1[i], group1[i - 1]) > spacing1 * 2) continue;\n\n            let n = rot(norm(plus(min(group1[i], group1[i + 1]), min(group1[i - 1], group1[i]))));\n            let add = plus(group1[i], mul(n, width * fac));\n\n            this.drawArrow(group1[i], mul(n, width * fac), \"pink\");\n            //this.drawArrow(group1[i], plus(min(group1[i], group1[i + 1]), min(group1[i - 1], group1[i])), \"green\");\n\n            let closest = this.findClosestPoint(group2, add);\n            if (d(add, closest) > spacing2 * 0.5) this.drawCircleRaw(add[0], add[1], 5, color);\n        }\n    }\n    download() {\n        var dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(this.trackData));\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var dlAnchorElem = document.getElementById(\"downloadAnchorElem\")!;\n        dlAnchorElem.setAttribute(\"href\", dataStr);\n        dlAnchorElem.setAttribute(\"download\", \"trackCones.json\");\n        dlAnchorElem.click();\n    }\n    private pythonLoading = true;\n    async calculatePython() {\n        if (this.pythonLoading || this.pyodide == null) return;\n        this.pythonLoading = true;\n\n        try {\n            let filtered = this.trackData.pylons.filter((d) => !d.hidden && !d.undetect);\n            /* const data = await (\n            await fetch(\n                \"http://localhost:3000?\" +\n                    new URLSearchParams({\n                        b: JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y])),\n                        y: JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y])),\n                        f: JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y])),\n                    })\n            )\n        ).text();*/\n            this.pyodide.globals.set(\"args\", {\n                cone_blue: JSON.stringify(filtered.filter((d) => d.color == \"#0000FF\").map((o) => [o.x, o.y])),\n                cone_yellow: JSON.stringify(filtered.filter((d) => d.color == \"#FF0000\").map((o) => [o.x, o.y])),\n                faulty_cones: JSON.stringify(this.trackData.pylons.filter((d) => d.undetect).map((o) => [o.x, o.y])),\n            });\n            await this.pyodide.runPythonAsync(\"print(args)\");\n\n            await this.pyodide.runPythonAsync(`\n            import sys\n            from js import fetch\n            async def fetch_and_decode(url):\n                jsbuf = await (await fetch(url)).arrayBuffer()\n                pybuf = bytearray(jsbuf.to_py())\n                return pybuf\n\n            with open('christofides.py', 'wb') as f:\n                f.write(await fetch_and_decode(\"./python/christofides.py\"))\n            sys.path.insert(0, '.')\n        `);\n            console.warn(\"AFTER CODE1\");\n            const code = await (await fetch(\"./python/main.py\")).text();\n            console.log(await this.pyodide.runPythonAsync(\"__name__='__main__'\\n\" + code));\n            console.warn(\"AFTER CODE2\");\n            const [blueDetected, yellowDetected, midLine] = this.pyodide.globals.get(\"result\").toJs();\n            this.output += `\n            cone_blue_detected = ${JSON.stringify(blueDetected)}\n            cone_yellow_detected = ${JSON.stringify(yellowDetected)}\n            midLine = ${JSON.stringify(midLine)}`;\n        } catch (e) {\n            console.warn(e);\n        } finally {\n            this.pythonLoading = false;\n        }\n    }\n\n    async openDemo(fileName: string) {\n        this.reset();\n        const text = await (await fetch(fileName)).text();\n        let result = YAML.parse(text) as YAMLFile;\n        this.loadYAMLFile(result);\n    }\n    async YAMLFilesChange(event: Event) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var files = (event.target as HTMLInputElement).files!;\n        console.log(files);\n        let result = YAML.parse(await files[0].text()) as YAMLFile;\n        this.loadYAMLFile(result);\n    }\n    loadYAMLFile(result: YAMLFile) {\n        const { cones_left, cones_orange, cones_orange_big, cones_right } = result;\n\n        console.log([cones_left, cones_orange, cones_orange_big, cones_right]);\n\n        const parsedSets = [cones_left, cones_orange, cones_orange_big, cones_right].map((list) =>\n            list.map((p) => p.split(\"\\n\").map((x) => parseFloat(x.trim().slice(1))))\n        ); //parse numbers\n\n        const list = parsedSets.flat();\n        //normalize\n        const [minX, maxX] = [list.map((p) => p[0]).min(), list.map((p) => p[0]).max()];\n        const [minY, maxY] = [list.map((p) => p[1]).min(), list.map((p) => p[1]).max()];\n        //const scale = Math.min(1 / (maxX - minX), 1 / (maxY - minY));\n        const scale = Math.min(1 / (maxX - minX), 1 / (maxY - minY));\n        const offset = [-minX, -minY] as const;\n\n        const trackSets = parsedSets\n            .map((list) => {\n                return list.map((p) => mul(plus(p as [number, number], offset), scale));\n            }) //scale to 500x500 with padding\n            .map((list) =>\n                list.map((p) => plus(mul(p as [number, number], 450).map((x) => Math.round(x * 100) / 100) as [number, number], [25, 25]))\n            );\n\n        trackSets.forEach((list, i) =>\n            list.forEach((p) => {\n                this.drawCircleRaw(p[0], p[1], 5, [\"blue\", \"yellow\", \"orange\", \"red\", \"green\"][i]);\n            })\n        );\n        this.trackData.pylons = [\n            ...trackSets[0].map(([x, y]) => ({ x, y, color: \"#0000FF\" })),\n            ...trackSets[3].map(([x, y]) => ({ x, y, color: \"#FF0000\" })),\n        ];\n    }\n\n    async JSONFilesChange(event: Event) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var files = (event.target as HTMLInputElement).files!;\n        console.log(files);\n        let result = JSON.parse(await files[0].text()) as Track;\n        this.reset();\n        this.trackData = result;\n        this.redraw();\n    }\n    redraw() {\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        this.trackData.pylons.forEach(({ x, y, color, hidden, undetect }) =>\n            this.drawCircleRaw(x, y, 5, hidden ? \"#DDDDDD\" : undetect ? \"#000\" : color)\n        );\n\n        this.strokePolygon(this.detection.blueDetected || [], \"#7777FF\", 3, true, true);\n        this.strokePolygon(this.detection.yellowDetected || [], \"#FF7777\", 3, true, true);\n        this.strokePolygon(this.detection.midLine || [], \"#00FF00\", 5, true, true);\n\n        this.strokePolygon(this.trackData.groundTruth, \"#000000\", 3, true, false);\n    }\n    strokePolygon(pointsArray: [number, number][], strokeColor: string, radius: number, stroke?: boolean, circles?: boolean) {\n        if (pointsArray.length <= 0) return;\n        this.context.beginPath();\n\n        if (strokeColor) this.context.strokeStyle = strokeColor;\n        if (stroke)\n            for (let i = 0; i < pointsArray.length - 1; i++) {\n                this.drawArrow(pointsArray[i], min(pointsArray[i + 1], pointsArray[i]), strokeColor);\n                //this.context.lineTo(pointsArray[i][0] * scale + offset, pointsArray[i][1] * scale + offset);\n            }\n        this.context.stroke();\n        if (circles)\n            for (let i = 0; i < pointsArray.length; i++) {\n                this.drawCircle(pointsArray[i][0], pointsArray[i][1], radius, strokeColor);\n            }\n    }\n}\n\nfunction d(p: readonly [number, number], p2: readonly [number, number]) {\n    return Math.sqrt(Math.pow(p[0] - p2[0], 2) + Math.pow(p[1] - p2[1], 2));\n}\nfunction plus(p: readonly [number, number], p2: readonly [number, number]) {\n    return [p[0] + p2[0], p[1] + p2[1]] as const;\n}\nfunction min(p: readonly [number, number], p2: readonly [number, number]) {\n    return [p[0] - p2[0], p[1] - p2[1]] as const;\n}\nfunction mul(p: readonly [number, number], p2: number | [number, number]): readonly [number, number] {\n    if (typeof p2 == \"number\") return [p[0] * p2, p[1] * p2] as const;\n    return [p[0] * p2[0], p[1] * p2[1]] as const;\n}\nfunction norm(p: readonly [number, number]) {\n    return mul(p, 1 / d(p, [0, 0]));\n}\nfunction rot(p: readonly [number, number]) {\n    return [p[1], -p[0]] as const;\n}\n\ndeclare global {\n    interface Array<T> {\n        median(): T;\n        mean(): T;\n        max(): T;\n        min(): T;\n    }\n}\n\nArray.prototype.median = function <T>(this: T[]): T {\n    if (this.length == 0) throw new Error(\"Array.median invoced with empty array\");\n    if (this.length % 2 === 0) {\n        let a = this[this.length / 2 - 1];\n        let b = this[this.length / 2 - 1];\n        if (typeof a != \"number\" || typeof b != \"number\") throw new Error(\"median values non numeric in array with even size\");\n        // Average Of Two Middle Numbers\n        return ((a + b) / 2) as unknown as T;\n    }\n    return this[(this.length - 1) / 2];\n};\nArray.prototype.mean = function (this: number[]): number {\n    var num = 0;\n    for (var i = 0, l = this.length; i < l; i++) num += this[i];\n    return num / this.length;\n};\nArray.prototype.max = function () {\n    return Math.max.apply(null, this);\n};\n\nArray.prototype.min = function () {\n    return Math.min.apply(null, this);\n};\n","import { render } from \"./TrackCanvas.vue?vue&type=template&id=033d66a4\"\nimport script from \"./TrackCanvas.vue?vue&type=script&lang=ts\"\nexport * from \"./TrackCanvas.vue?vue&type=script&lang=ts\"\n\nimport \"./TrackCanvas.vue?vue&type=style&index=0&id=033d66a4&l=true&lang=css\"\nscript.render = render\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./TrackCanvas.vue?vue&type=style&index=0&id=033d66a4&l=true&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DemoChooser.vue?vue&type=style&index=0&id=e202a66e&lang=css\"","<template>\n    <transition name=\"modal\">\n        <div class=\"modal-mask\" v-if=\"showModal\">\n            <div class=\"modal-wrapper\" @click.self=\"showModal = false\">\n                <div class=\"modal-dialog modal-lg\" role=\"document\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">Choose Demo Track</h5>\n                            <button type=\"button\" class=\"btn-close p-3\" @click=\"showModal = false\"></button>\n                        </div>\n                        <div class=\"modal-body row\" style=\"max-height: 80vh; overflow: auto\">\n                            <div class=\"col-12 col-md-6 col-lg-4 col-xl-3\" v-for=\"track in tracks\" :key=\"track\" @click=\"select(track.path)\">\n                                <div class=\"card mb-4\">\n                                    <img class=\"card-img-top\" :src=\"track.img\" @error=\"track.img = 'https://demofree.sirv.com/nope-not-here.jpg'\" />\n                                    <div class=\"card-body\">\n                                        <h6 class=\"card-text\">{{ track.name }}</h6>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </transition>\n    <button @click=\"showModal = true\" class=\"btn btn-primary my-2 me-4\">Open Demo Track...</button>\n</template>\n\n<script lang=\"ts\">\nimport { Options, Vue } from \"vue-class-component\";\n\n@Options({})\nexport default class DemoChooser extends Vue {\n    private showModal = false;\n    private tracks = [\n        \"acceleration\",\n        \"FSG\",\n        \"skidpad\",\n        \"track_1\",\n        ...Array(100)\n            .fill(0)\n            .map((_, i) => `random_track_${(\"00\" + i).slice(-3)}`),\n    ].map((track) => ({ name: track, img: `./YAML/${track}.png`, path: `./YAML/${track}.yaml` }));\n\n    select(path: string) {\n        this.showModal = false;\n        this.$emit(\"fileSelected\", path);\n    }\n}\n</script>\n\n<style>\n.modal-mask {\n    position: fixed;\n    z-index: 9998;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: table;\n}\n\n.modal-wrapper {\n    display: table-cell;\n    vertical-align: middle;\n}\n\n.modal-container {\n    width: 300px;\n    margin: 0px auto;\n    padding: 20px 30px;\n    background-color: #fff;\n    border-radius: 2px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.33);\n    font-family: Helvetica, Arial, sans-serif;\n}\n\n.modal-header h3 {\n    margin-top: 0;\n    color: #42b983;\n}\n\n.modal-body {\n    margin: 20px 0;\n}\n\n.modal-default-button {\n    display: block;\n    margin-top: 1rem;\n}\n\n.modal-enter-active,\n.modal-leave-active {\n    transition: opacity 0.2s ease;\n}\n\n.modal-enter-from,\n.modal-leave-to {\n    opacity: 0;\n}\n</style>\n","\nimport { Options, Vue } from \"vue-class-component\";\n\n@Options({})\nexport default class DemoChooser extends Vue {\n    private showModal = false;\n    private tracks = [\n        \"acceleration\",\n        \"FSG\",\n        \"skidpad\",\n        \"track_1\",\n        ...Array(100)\n            .fill(0)\n            .map((_, i) => `random_track_${(\"00\" + i).slice(-3)}`),\n    ].map((track) => ({ name: track, img: `./YAML/${track}.png`, path: `./YAML/${track}.yaml` }));\n\n    select(path: string) {\n        this.showModal = false;\n        this.$emit(\"fileSelected\", path);\n    }\n}\n","import { render } from \"./DemoChooser.vue?vue&type=template&id=e202a66e\"\nimport script from \"./DemoChooser.vue?vue&type=script&lang=ts\"\nexport * from \"./DemoChooser.vue?vue&type=script&lang=ts\"\n\nimport \"./DemoChooser.vue?vue&type=style&index=0&id=e202a66e&lang=css\"\nscript.render = render\n\nexport default script","<template>\n    <nav class=\"navbar navbar-dark bg-secondary d-flex p-0\">\n        <div class=\"container px-3 py-2\">\n            <a href=\"#\" class=\"navbar-brand align-bottom router-link-active\">TrackVisualizer</a>\n        </div>\n    </nav>\n    <div class=\"container d-flex align-items-stretch justify-content-center flex-column\">\n        <div class=\"card card-default mt-5\">\n            <div class=\"card-header\">Canvas</div>\n            <div class=\"card-body\">\n                <TrackCanvas />\n            </div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport { Options, Vue } from \"vue-class-component\";\n\n@Options({})\nexport default class App extends Vue {}\n</script>\n\n<style></style>\n","\nimport { Options, Vue } from \"vue-class-component\";\n\n@Options({})\nexport default class App extends Vue {}\n","import { render } from \"./App.vue?vue&type=template&id=0c065bc4\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport \"bootstrap\"\nimport \"bootstrap/dist/css/bootstrap.min.css\"\n\nimport upperFirst from \"lodash/upperFirst\";\nimport camelCase from \"lodash/camelCase\";\n\nconst app = createApp(App);\n(window as any).app = app;\n\nconst requireComponent = (require as any).context(\n    // The relative path of the components folder\n    \"./components\",\n    // Whether or not to look in subfolders\n    true,\n    // The regular expression used to match base component filenames\n    /.+\\.(vue|js|ts)$$/\n);\nrequireComponent.keys().forEach((fileName: any) => {\n    // Get component config\n    const componentConfig = requireComponent(fileName);\n\n    // Get PascalCase name of component\n    const componentName = upperFirst(\n        camelCase(\n            // Gets the file name regardless of folder depth\n            fileName\n                .split(\"/\")\n                .pop()\n                .replace(/\\.\\w+$/, \"\")\n        )\n    );\n    // Register component globally\n    app.component(\n        componentName,\n        // Look for the component options on `.default`, which will\n        // exist if the component was exported with `export default`,\n        // otherwise fall back to module's root.\n        componentConfig.default || componentConfig\n    );\n});\n\napp.mount(\"#app\")"],"sourceRoot":""}